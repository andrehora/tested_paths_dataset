<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>tarfile.TarFile.__init__</title>
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7" />
<!--    <link rel="icon" sizes="32x32" href="favicon_32.png">-->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>&#128270;</text></svg>">
    <link rel="stylesheet" href="highlight.css" type="text/css">
</head>
<body class="pyfile">
<div id="source">
    <div class="highlight">
        <div id="header">
            <div class="content">
                <h1>Method: tarfile.TarFile.__init__</h1>
                <span>Calls: 2442, </span>
                <span>Exceptions: 1426, </span>
                <span>Paths: 45</span>
                <br><a href="index.html">Back</a>
            </div>
        </div>
            <p><b>Path 1</b>: 747 calls (0.31)</p>
                <p><button class="input"><span>&#8594;</span> name</button> None (350) '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (301) '/Library/Frameworks/Python.framewo...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (747) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (386) LZMAFile (277) Bz2PartialReadTest._test_partial_input.<locals>.MyBytesIO (74) BytesIO (10) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (747) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (747) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (747) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> LZMAError (235) EOFError (215) OSError (201) ReadError (96) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 2</b>: 256 calls (0.1)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (182) '/Library/Frameworks/Python.framework/Versions...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (256) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (243) _Stream (13) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (256) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (256) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (256) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> BadGzipFile (214) ReadError (42) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 3</b>: 156 calls (0.06)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (133) '/Library/Frameworks/Python.framework/Versions...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (156) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (156) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (156) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (156) </p>
            <button class="run" title="lines run...">32 run</button>
            <button class="not_run" title="lines not run...">37 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 4</b>: 138 calls (0.06)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (55) None (39) '/Users/andrehora/Documents/git/proje...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (138) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (78) LZMAFile (55) BytesIO (5) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (138) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (138) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (138) </p>
            <button class="run" title="lines run...">32 run</button>
            <button class="not_run" title="lines not run...">37 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 5</b>: 134 calls (0.05)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/test/testtar.tar' (108) '/Users/andrehora/Documents/git/projects-pathspotter/python...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (134) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (114) 'utf-8' (15) 'utf7' (3) 'ascii' (2) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (131) 'strict' (3) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (134) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (134) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 6</b>: 122 calls (0.05)</p>
                <p><button class="input"><span>&#8594;</span> name</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (122) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (114) BufferedReader (8) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (122) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (122) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (122) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> BadGzipFile (105) ReadError (17) </p>
            <button class="run" title="lines run...">37 run</button>
            <button class="not_run" title="lines not run...">32 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 7</b>: 120 calls (0.05)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/test/testtar.tar' (68) '/Users/andrehora/Documents/git/projects-pathspotter/python-...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (120) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (60) LZMAFile (60) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (80) 'utf-8' (30) 'utf7' (6) 'ascii' (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (114) 'strict' (6) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (120) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (120) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> OSError (60) LZMAError (60) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 8</b>: 111 calls (0.05)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (103) '/Users/andrehora/Documents/git/projects-paths...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (99) 'x' (12) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (111) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (111) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (111) </p>
            <button class="run" title="lines run...">32 run</button>
            <button class="not_run" title="lines not run...">37 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 9</b>: 88 calls (0.04)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/testtar.tar.gz' (52) '/Users/andrehora/Documents/git/projects...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (88) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> _Stream (48) GzipFile (40) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (88) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (88) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (88) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (88) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 10</b>: 82 calls (0.03)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (70) None (8) PosixPath (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (62) 'x' (20) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (39) LZMAFile (39) BytesIO (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (82) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (82) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (82) </p>
            <button class="run" title="lines run...">32 run</button>
            <button class="not_run" title="lines not run...">37 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 11</b>: 80 calls (0.03)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/testtar.tar.bz2' (40) '/Users/andrehora/Documents/git/project...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (80) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (40) LZMAFile (40) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (80) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (80) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (80) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (80) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 12</b>: 74 calls (0.03)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (32) '/Users/andrehora/Documents/git/projects-pathsp...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (74) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (49) _Stream (21) BufferedReader (3) FileIO (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (74) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (74) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (74) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 13</b>: 60 calls (0.02)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/test/testtar.tar' (34) '/Users/andrehora/Documents/git/projects-pathspotter/python-...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (60) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (60) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (40) 'utf-8' (15) 'utf7' (3) 'ascii' (2) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (57) 'strict' (3) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (60) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (60) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> BadGzipFile (60) </p>
            <button class="run" title="lines run...">36 run</button>
            <button class="not_run" title="lines not run...">33 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 14</b>: 54 calls (0.02)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (52) PosixPath (2) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (46) 'x' (8) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (37) _Stream (17) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (54) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (54) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (54) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 15</b>: 48 calls (0.02)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (17) PosixPath (8) '/Library/Frameworks/Python.frame...</p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (48) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (48) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (48) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (48) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ReadError (48) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 16</b>: 38 calls (0.02)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (38) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (38) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> format</button> 0 (28) 1 (5) 2 (5) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'utf-8' (26) 'iso8859-1' (7) 'utf7' (3) 'ascii' (2) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (27) 'strict' (11) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (38) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (38) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 17</b>: 13 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> name</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (13) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (9) BufferedReader (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (13) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (13) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (13) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 18</b>: 12 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (12) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (12) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (12) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> True (12) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (12) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (12) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> BadGzipFile (12) </p>
            <button class="run" title="lines run...">36 run</button>
            <button class="not_run" title="lines not run...">33 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 19</b>: 12 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (12) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (12) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (8) LZMAFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> True (12) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (12) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (12) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> OSError (8) ReadError (2) LZMAError (2) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 20</b>: 9 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (9) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (9) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (3) LZMAFile (3) WriteTest.test_open_nonwritable_fileobj.<locals>.BadFile (3) </p>
                <p><button class="input"><span>&#8594;</span> format</button> 2 (9) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (9) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> {'non': 'empty'} (9) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (9) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> OSError (3) EOFError (3) RuntimeError (3) </p>
            <button class="run" title="lines run...">39 run</button>
            <button class="not_run" title="lines not run...">30 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 21</b>: 9 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (9) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (9) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> format</button> 2 (9) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (9) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (9) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (9) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 22</b>: 8 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/test/testtar.tar' (8) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (8) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (4) LZMAFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (8) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (8) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> 1 (8) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (8) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> OSError (4) LZMAError (4) </p>
            <button class="run" title="lines run...">36 run</button>
            <button class="not_run" title="lines not run...">33 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 23</b>: 8 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (8) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (8) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (4) LZMAFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> True (8) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (8) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (8) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 24</b>: 8 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/testsymlinks.tar' (8) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (8) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (4) LZMAFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (8) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (8) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> 2 (8) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (8) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> OSError (4) LZMAError (4) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 25</b>: 7 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (6) 'x' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> _Stream (4) GzipFile (2) BufferedWriter (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (7) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (7) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (7) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">34 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 26</b>: 6 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (6) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (6) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (6) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (6) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ReadError (6) </p>
            <button class="run" title="lines run...">41 run</button>
            <button class="not_run" title="lines not run...">28 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 27</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/test/testtar.tar' (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (4) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> 1 (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> BadGzipFile (4) </p>
            <button class="run" title="lines run...">37 run</button>
            <button class="not_run" title="lines not run...">32 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 28</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/test/testtar.tar' (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (4) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> 1 (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 29</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/testsymlinks.tar' (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (4) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> 2 (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> BadGzipFile (4) </p>
            <button class="run" title="lines run...">36 run</button>
            <button class="not_run" title="lines not run...">33 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 30</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/testsymlinks.tar' (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (4) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> 2 (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 31</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (3) 'xxx' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'x' (3) 'r' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> FileExistsError (3) FileNotFoundError (1) </p>
            <button class="run" title="lines run...">7 run</button>
            <button class="not_run" title="lines not run...">62 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full not_run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full not_run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full not_run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 32</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (4) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> True (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 33</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (4) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (4) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> True (4) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (4) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (4) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 34</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (2) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (2) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (2) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ReadError (2) </p>
            <button class="run" title="lines run...">42 run</button>
            <button class="not_run" title="lines not run...">27 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 35</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (2) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (2) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BZ2File (1) LZMAFile (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (2) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (2) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (2) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 36</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> EOFHeaderError (1) </p>
            <button class="run" title="lines run...">39 run</button>
            <button class="not_run" title="lines not run...">30 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 37</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BytesIO (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> EOFHeaderError (1) </p>
            <button class="run" title="lines run...">39 run</button>
            <button class="not_run" title="lines not run...">30 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 38</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> EOFHeaderError (1) </p>
            <button class="run" title="lines run...">40 run</button>
            <button class="not_run" title="lines not run...">29 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 39</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BytesIO (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> EOFHeaderError (1) </p>
            <button class="run" title="lines run...">40 run</button>
            <button class="not_run" title="lines not run...">29 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 40</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'a' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 41</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> GzipFile (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 42</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BytesIO (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 43</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'r' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> BufferedReader (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">35 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full not_run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full not_run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 44</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> 2 (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> {'foo': 'bar', 'uid': '0', 'mtime': '1.23', 'test': '&#228;&#246;&#252;', '&#228;&#246;&#252;': 'test'} (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
            <button class="run" title="lines run...">36 run</button>
            <button class="not_run" title="lines not run...">33 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
            <p><b>Path 45</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> name</button> '/Users/andrehora/Documents/git/projects-pathspotter/python-libs/@test_69456_tmp&#230;-tardir/tmp.tar' (1) </p>
                <p><button class="input"><span>&#8594;</span> mode</button> 'w' (1) </p>
                <p><button class="input"><span>&#8594;</span> fileobj</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> format</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> tarinfo</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> dereference</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> ignore_zeros</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> encoding</button> 'iso8859-1' (1) </p>
                <p><button class="input"><span>&#8594;</span> errors</button> 'surrogateescape' (1) </p>
                <p><button class="input"><span>&#8594;</span> pax_headers</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> debug</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> errorlevel</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> copybufsize</button> None (1) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">36 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>            <span class="n">tarinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_zeros</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#3">3</a></span><span>            <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;surrogateescape&quot;</span><span class="p">,</span> <span class="n">pax_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span></span>
<span class="num"><a href="#4">4</a></span><span>            <span class="n">errorlevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copybufsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open an (uncompressed) tar archive `name&#39;. `mode&#39; is either &#39;r&#39; to</span></span>
<span class="num"><a href="#6">6</a></span><span><span class="sd">           read from an existing archive, &#39;a&#39; to append data to an existing</span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">           file or &#39;w&#39; to create a new file overwriting an existing one. `mode&#39;</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">           defaults to &#39;r&#39;.</span></span>
<span class="num"><a href="#9">9</a></span><span><span class="sd">           If `fileobj&#39; is given, it is used for reading or writing data. If it</span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">           can be determined, `mode&#39; is overridden by `fileobj&#39;s mode.</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">           `fileobj&#39; is not closed, when TarFile is closed.</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#13">13</a></span><span class="full run">        <span class="n">modes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;xb&quot;</span><span class="p">}</span></span>
<span class="num"><a href="#14">14</a></span><span class="full run">        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span></span>
<span class="num"><a href="#15">15</a></span><span class="full not_run">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;r&#39;, &#39;a&#39;, &#39;w&#39; or &#39;x&#39;&quot;</span><span class="p">)</span></span>
<span class="num"><a href="#16">16</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span></span>
<span class="num"><a href="#17">17</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span></span>
<span class="num"><a href="#18">18</a></span><span></span>
<span class="num"><a href="#19">19</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span></span>
<span class="num"><a href="#20">20</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span></span>
<span class="num"><a href="#21">21</a></span><span>                <span class="c1"># Create nonexistent files in append mode.</span></span>
<span class="num"><a href="#22">22</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></span>
<span class="num"><a href="#23">23</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="s2">&quot;wb&quot;</span></span>
<span class="num"><a href="#24">24</a></span><span class="full run">            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">bltn_open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span></span>
<span class="num"><a href="#25">25</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#26">26</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#27">27</a></span><span class="full not_run">            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span></span>
<span class="num"><a href="#28">28</a></span><span class="full not_run">                <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))):</span></span>
<span class="num"><a href="#29">29</a></span><span class="full not_run">                <span class="n">name</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">name</span></span>
<span class="num"><a href="#30">30</a></span><span class="full not_run">            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#31">31</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span></span>
<span class="num"><a href="#32">32</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#33">33</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span></span>
<span class="num"><a href="#34">34</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span> <span class="o">=</span> <span class="n">fileobj</span></span>
<span class="num"><a href="#35">35</a></span><span></span>
<span class="num"><a href="#36">36</a></span><span>        <span class="c1"># Init attributes.</span></span>
<span class="num"><a href="#37">37</a></span><span class="full run">        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#38">38</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="nb">format</span></span>
<span class="num"><a href="#39">39</a></span><span class="full run">        <span class="k">if</span> <span class="n">tarinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#40">40</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span> <span class="o">=</span> <span class="n">tarinfo</span></span>
<span class="num"><a href="#41">41</a></span><span class="full run">        <span class="k">if</span> <span class="n">dereference</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#42">42</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">        <span class="k">if</span> <span class="n">ignore_zeros</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#44">44</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_zeros</span> <span class="o">=</span> <span class="n">ignore_zeros</span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#46">46</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></span>
<span class="num"><a href="#48">48</a></span><span></span>
<span class="num"><a href="#49">49</a></span><span class="full run">        <span class="k">if</span> <span class="n">pax_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">PAX_FORMAT</span><span class="p">:</span></span>
<span class="num"><a href="#50">50</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="n">pax_headers</span></span>
<span class="num"><a href="#51">51</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#52">52</a></span><span class="full run">            <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span> <span class="o">=</span> <span class="p">{}</span></span>
<span class="num"><a href="#53">53</a></span><span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#55">55</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="k">if</span> <span class="n">errorlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#57">57</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">errorlevel</span> <span class="o">=</span> <span class="n">errorlevel</span></span>
<span class="num"><a href="#58">58</a></span><span></span>
<span class="num"><a href="#59">59</a></span><span>        <span class="c1"># Init datastructures.</span></span>
<span class="num"><a href="#60">60</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">copybufsize</span> <span class="o">=</span> <span class="n">copybufsize</span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># list of members as TarInfo objects</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># flag if all members have been read</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span></span>
<span class="num"><a href="#65">65</a></span><span>                                <span class="c1"># current position in the archive file</span></span>
<span class="num"><a href="#66">66</a></span><span class="full run">        <span class="bp">self</span><span class="o">.</span><span class="n">inodes</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># dictionary caching the inodes of</span></span>
<span class="num"><a href="#67">67</a></span><span>                                <span class="c1"># archive members already added</span></span>
<span class="num"><a href="#68">68</a></span><span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">firstmember</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></span>
<span class="num"><a href="#73">73</a></span><span></span>
<span class="num"><a href="#74">74</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span></span>
<span class="num"><a href="#75">75</a></span><span>                <span class="c1"># Move to the end of the archive,</span></span>
<span class="num"><a href="#76">76</a></span><span>                <span class="c1"># before the first empty block.</span></span>
<span class="num"><a href="#77">77</a></span><span class="full not_run">                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                        <span class="n">tarinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">fromtarfile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></span>
<span class="num"><a href="#81">81</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tarinfo</span><span class="p">)</span></span>
<span class="num"><a href="#82">82</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">EOFHeaderError</span><span class="p">:</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                        <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                        <span class="k">break</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="k">except</span> <span class="n">HeaderError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span></span>
<span class="num"><a href="#86">86</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="n">ReadError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="kn">from</span> <span class="kc">None</span></span>
<span class="num"><a href="#87">87</a></span><span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span class="full run">                <span class="bp">self</span><span class="o">.</span><span class="n">_loaded</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#90">90</a></span><span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="p">:</span></span>
<span class="num"><a href="#92">92</a></span><span class="full not_run">                    <span class="n">buf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tarinfo</span><span class="o">.</span><span class="n">create_pax_global_header</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pax_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#94">94</a></span><span class="full not_run">                    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">        <span class="k">except</span><span class="p">:</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extfileobj</span><span class="p">:</span></span>
<span class="num"><a href="#97">97</a></span><span class="full not_run">                <span class="bp">self</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#99">99</a></span><span class="full not_run">            <span class="k">raise</span></span>
            </pre>
    </div>
</div>
<i class="bi bi-arrow-down"></i>
</body>
</html>
