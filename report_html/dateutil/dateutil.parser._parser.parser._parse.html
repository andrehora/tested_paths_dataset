<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>dateutil.parser._parser.parser._parse</title>
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7" />
<!--    <link rel="icon" sizes="32x32" href="favicon_32.png">-->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>&#128270;</text></svg>">
    <link rel="stylesheet" href="highlight.css" type="text/css">
</head>
<body class="pyfile">
<div id="source">
    <div class="highlight">
        <div id="header">
            <div class="content">
                <h1>Method: dateutil.parser._parser.parser._parse</h1>
                <span>Calls: 1160, </span>
                <span>Exceptions: 1013, </span>
                <span>Paths: 47</span>
                <br><a href="index.html">Back</a>
            </div>
        </div>
            <p><b>Path 1</b>: 633 calls (0.55)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '19970902T090000' (261) '19971029T020000' (39) '19980301T020000' (31) '19980301T030000' (8) '19970904T090000' (7) '19970909T090000' (6) '19970911T0900...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (633) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (633) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (630) True (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (633) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (633) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (633) </p>
            <button class="run" title="lines run...">37 run</button>
            <button class="not_run" title="lines not run...">64 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 2</b>: 151 calls (0.13)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Thu Sep 25 2003' (2) 'Thu Sep 25 10:36:28 2003' (1) 'Thu Sep 25 10:36:28' (1) 'Wed Jul 11 06:06:06 1906' (1) 'Mon Aug 12 07:07:07 1907' (1) 'Sat Sep ...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (151) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (151) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (151) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (151) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (151) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (151) </p>
            <button class="run" title="lines run...">45 run</button>
            <button class="not_run" title="lines not run...">56 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 3</b>: 129 calls (0.11)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2003-Sep-25' (3) '25-Sep-2003' (3) '2003/Sep/25' (3) '25/Sep/2003' (3) '2003.Sep.25' (3) '25.Sep.2003' (3) '19970902' (3) '2003-09-25' (2) '20030925'...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (129) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (129) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (128) True (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (129) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (129) </p>
            <button class="run" title="lines run...">28 run</button>
            <button class="not_run" title="lines not run...">73 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 4</b>: 57 calls (0.05)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> "Wed, July 10, '96" (1) 'Mon Jan  2 04:24:27 1995' (1) 'Thu Sep 10:36:28' (1) 'Sa 21. Jan 2017' (1) 'Mon Jan  1 00:00:00 1900' (1) 'Sat Feb  2 01:01:0...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (57) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (57) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (57) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (57) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (57) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (57) </p>
            <button class="run" title="lines run...">44 run</button>
            <button class="not_run" title="lines not run...">57 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 5</b>: 45 calls (0.04)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2003 Sep 25' (3) '25 Sep 2003' (3) 'Sep.25.2003' (3) '2003 September 25' (2) '25 September 2003' (2) 'Sep.2003.25' (2) 'September.2003.25' (2) 'Septe...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (45) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (45) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (44) True (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (45) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (45) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (45) </p>
            <button class="run" title="lines run...">42 run</button>
            <button class="not_run" title="lines not run...">59 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 6</b>: 18 calls (0.02)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Sep-25-2003' (3) 'Sep/25/2003' (3) 'Sep-2003-25' (2) 'September-2003-25' (2) 'September-25-2003' (2) 'Sep/2003/25' (2) 'September/2003/25' (2) 'Septe...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (18) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (18) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (18) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (18) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (18) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (18) </p>
            <button class="run" title="lines run...">41 run</button>
            <button class="not_run" title="lines not run...">60 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 7</b>: 12 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2017-02-03 12:40 BRST' (2) '2011-11-06T01:30 EST' (2) '1996.07.10 AD at 15:08:56 PDT' (1) '1994-11-05T08:15:30Z' (1) '1976-07-04T00:01:02Z' (1) '1986...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (12) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (12) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (12) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (12) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (12) </p>
            <button class="run" title="lines run...">40 run</button>
            <button class="not_run" title="lines not run...">61 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 8</b>: 11 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '03 25 Sep' (2) '2003 25 Sep' (2) '25 2003 Sep' (2) '2003 25 September' (2) '25 2003 September' (2) '25 03 Sep' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (11) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (11) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (11) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (11) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (11) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (11) </p>
            <button class="run" title="lines run...">35 run</button>
            <button class="not_run" title="lines not run...">66 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 9</b>: 11 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '1996.July.10 AD 12:08 PM' (1) '10h am' (1) '10h pm' (1) '10:00 am' (1) '10:00 pm' (1) '10:00a.m' (1) '10:00p.m' (1) '10:00a.m.' (1) '10:00p.m.' (1) '...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (11) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (11) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (11) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (11) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (11) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (11) </p>
            <button class="run" title="lines run...">42 run</button>
            <button class="not_run" title="lines not run...">59 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 10</b>: 11 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Sep 25 2003' (3) 'Sep 2003 25' (2) 'September 2003 25' (2) 'September 25 2003' (2) 'Jan 1 1999 11:23:34.578' (1) '10 &#1057;&#1077;&#1085;&#1090;&#1103;&#1073;&#1088;&#1100; 2015 10:20' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (11) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (11) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (11) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (11) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (11) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (11) </p>
            <button class="run" title="lines run...">43 run</button>
            <button class="not_run" title="lines not run...">58 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 11</b>: 6 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '10-09-2003' (1) '10.09.2003' (1) '10/09/2003' (1) '10 09 2003' (1) '090107' (1) '2015 09 25' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> True (6) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (6) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (6) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (6) </p>
            <button class="run" title="lines run...">27 run</button>
            <button class="not_run" title="lines not run...">74 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full not_run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 12</b>: 6 calls (0.01)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2010-09-03' (1) '2010.09.03' (1) '2010/09/03' (1) '2010 09 03' (1) '2015 09 25' (1) '090107' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (6) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> True (6) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (6) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (6) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (6) </p>
            <button class="run" title="lines run...">27 run</button>
            <button class="not_run" title="lines not run...">74 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full not_run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 13</b>: 5 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '1994-11-05T08:15:30-05:00' (1) '2003-09-25T10:49:41.5-03:00' (1) '2003-09-25T10:49:41-03:00' (1) '2003-09-25T10:49:41+03:00' (1) '2014-07-20T12:34:56...</p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (5) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (5) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (5) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (5) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (5) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (5) </p>
            <button class="run" title="lines run...">47 run</button>
            <button class="not_run" title="lines not run...">54 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 14</b>: 5 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2014 January 19 09:00 UTC' (5) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (5) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (5) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (5) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (5) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (5) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (5) </p>
            <button class="run" title="lines run...">46 run</button>
            <button class="not_run" title="lines not run...">55 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 15</b>: 5 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '090107' (4) '2015 09 25' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> True (3) False (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> True (3) False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (5) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (5) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (5) </p>
            <button class="run" title="lines run...">26 run</button>
            <button class="not_run" title="lines not run...">75 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full not_run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full not_run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 16</b>: 4 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '04/04/32/423' (1) '04/04/04 +32423' (1) '04/04/0d4' (1) 'SMITH R &  WEISS D 94 CHILD TR FBO M W SMITH UDT 12/1/1994' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (4) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (4) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> True (4) </p>
                <p><button class="output"><span>&#8617; return</span></button> (None, None) (4) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (4) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">68 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 17</b>: 3 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Thu Sep 25 10:36:28 BRST 2003' (2) 'Tue Apr 4 00:22:12 PDT 1995' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (3) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (3) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (3) </p>
            <button class="run" title="lines run...">48 run</button>
            <button class="not_run" title="lines not run...">53 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 18</b>: 3 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'November 5, 1994, 8:15:30 am EST' (1) '5:50 A.M. on June 13, 1990' (1) '2:15 PM on January 2nd 1973 A.D.' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (3) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (3) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (3) </p>
            <button class="run" title="lines run...">50 run</button>
            <button class="not_run" title="lines not run...">51 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 19</b>: 3 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '20030925T104941-0300' (1) '20030925T104941.5-0300' (1) '20030925T104941+0300' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (3) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (3) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (3) </p>
            <button class="run" title="lines run...">45 run</button>
            <button class="not_run" title="lines not run...">56 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 20</b>: 3 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'shouldfail' (1) 'Frid Dec 30, 2016' (1) 'THECOWSCOMEHOME' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (3) </p>
                <p><button class="output"><span>&#8617; return</span></button> (None, None) (3) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (3) </p>
            <button class="run" title="lines run...">29 run</button>
            <button class="not_run" title="lines not run...">72 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full not_run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full not_run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 21</b>: 3 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '201A-01-01T23:58:39.239769+03:00' (1) '1: test' (1) 'Nan' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (3) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (3) </p>
                <p><button class="output"><span>&#8617; return</span></button> (None, None) (3) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (3) </p>
            <button class="run" title="lines run...">21 run</button>
            <button class="not_run" title="lines not run...">80 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full not_run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full not_run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 22</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '13NOV2017' (1) '02:17NOV2017' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">37 run</button>
            <button class="not_run" title="lines not run...">64 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 23</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Sep' (1) 'October' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">34 run</button>
            <button class="not_run" title="lines not run...">67 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 24</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '10:00am' (1) '10:00pm' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">38 run</button>
            <button class="not_run" title="lines not run...">63 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 25</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Wed' (1) 'Wednesday' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">32 run</button>
            <button class="not_run" title="lines not run...">69 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 26</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> None (1) 13 (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> TypeError (2) </p>
            <button class="run" title="lines run...">8 run</button>
            <button class="not_run" title="lines not run...">93 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full not_run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full not_run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full not_run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full not_run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full not_run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full not_run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full not_run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full not_run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full not_run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full not_run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full not_run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 27</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'AM' (1) 'A.D.2001' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> (None, None) (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">27 run</button>
            <button class="not_run" title="lines not run...">74 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full not_run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full not_run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 28</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '13:44 AM' (1) '2014-02-28 25:16 PM' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> (None, None) (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">33 run</button>
            <button class="not_run" title="lines not run...">68 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full not_run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 29</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'I have a meeting on March 1, 1974.' (1) 'On June 8th, 2020, I am going to be the first man on Mars' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> True (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">47 run</button>
            <button class="not_run" title="lines not run...">54 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 30</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Meet me at the AM/PM on Sunset at 3:00 AM on December 3rd, 2003' (1) 'Meet me at 3:00AM on December 3rd, 2003 at the AM/PM on Sunset' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> True (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">49 run</button>
            <button class="not_run" title="lines not run...">52 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 31</b>: 2 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> "2011 MARTIN CHILDREN'S IRREVOCABLE TRUST u/a/d NOVEMBER 7, 2012" (1) "2012 MARTIN CHILDREN'S IRREVOCABLE TRUST u/a/d NOVEMBER 7, 2012" (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (2) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> True (2) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (2) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (2) </p>
            <button class="run" title="lines run...">49 run</button>
            <button class="not_run" title="lines not run...">52 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 32</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '  July   4 ,  1976   12:01:02   am  ' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">48 run</button>
            <button class="not_run" title="lines not run...">53 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 33</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'July 4, 1976 12:01:02 am' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">47 run</button>
            <button class="not_run" title="lines not run...">54 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 34</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Thu 10:36:28' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">39 run</button>
            <button class="not_run" title="lines not run...">62 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 35</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Tuesday, April 12, 1952 AD 3:30:42pm PST' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">52 run</button>
            <button class="not_run" title="lines not run...">49 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 36</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Thu, 25 Sep 2003 10:49:41 -0300' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">53 run</button>
            <button class="not_run" title="lines not run...">48 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 37</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
            <button class="run" title="lines run...">22 run</button>
            <button class="not_run" title="lines not run...">79 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full not_run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full not_run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full not_run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full not_run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full not_run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 38</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'January 25, 1921 23:13 PM' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> (None, None) (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">38 run</button>
            <button class="not_run" title="lines not run...">63 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full not_run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full not_run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full not_run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full not_run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 39</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2003 10:36:28 BRST 25 Sep Thu' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">47 run</button>
            <button class="not_run" title="lines not run...">54 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 40</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Today is 25 of September of 2003, exactly at 10:49:41 with timezone -03:00.' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> True (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">58 run</button>
            <button class="not_run" title="lines not run...">43 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 41</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Jan 29, 1945 14:45 AM I going to see you there?' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> True (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">50 run</button>
            <button class="not_run" title="lines not run...">51 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 42</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Today is 25 of September of 2003, exactly at 10:49:41 with timezone -03:00.' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> True (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">60 run</button>
            <button class="not_run" title="lines not run...">41 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 43</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'http://biz.yahoo.com/ipo/p/600221.html' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> True (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">44 run</button>
            <button class="not_run" title="lines not run...">57 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 44</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Sep of 03' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">42 run</button>
            <button class="not_run" title="lines not run...">59 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full not_run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full not_run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full not_run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full not_run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 45</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '0:00 PM, PST' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">45 run</button>
            <button class="not_run" title="lines not run...">56 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 46</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> '2014-02-28 25:16 PM' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> True (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> False (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">42 run</button>
            <button class="not_run" title="lines not run...">59 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full not_run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full not_run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full not_run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full not_run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
            <p><b>Path 47</b>: 1 calls (0.0)</p>
                <p><button class="input"><span>&#8594;</span> timestr</button> 'Berylson Amy Smith 1998 Grantor Retained Annuity Trust u/d/t November 2, 1998 f/b/o Jennifer L Berylson' (1) </p>
                <p><button class="input"><span>&#8594;</span> dayfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> yearfirst</button> None (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy</button> False (1) </p>
                <p><button class="input"><span>&#8594;</span> fuzzy_with_tokens</button> True (1) </p>
                <p><button class="output"><span>&#8617; return</span></button> tuple (1) </p>
                <p><button class="warning"><span>&#9888; exception</span></button> ValueError (1) </p>
            <button class="run" title="lines run...">47 run</button>
            <button class="not_run" title="lines not run...">54 not run</button>
            <pre>
<span class="num"><a href="#1">1</a></span><span><span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestr</span><span class="p">,</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yearfirst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fuzzy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span></span>
<span class="num"><a href="#2">2</a></span><span>               <span class="n">fuzzy_with_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span></span>
<span class="num"><a href="#3">3</a></span><span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></span>
<span class="num"><a href="#4">4</a></span><span><span class="sd">        Private method which performs the heavy lifting of parsing, called from</span></span>
<span class="num"><a href="#5">5</a></span><span><span class="sd">        ``parse()``, which passes on its ``kwargs`` to this function.</span></span>
<span class="num"><a href="#6">6</a></span><span></span>
<span class="num"><a href="#7">7</a></span><span><span class="sd">        :param timestr:</span></span>
<span class="num"><a href="#8">8</a></span><span><span class="sd">            The string to parse.</span></span>
<span class="num"><a href="#9">9</a></span><span></span>
<span class="num"><a href="#10">10</a></span><span><span class="sd">        :param dayfirst:</span></span>
<span class="num"><a href="#11">11</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#12">12</a></span><span><span class="sd">            (e.g. 01/05/09) as the day (``True``) or month (``False``). If</span></span>
<span class="num"><a href="#13">13</a></span><span><span class="sd">            ``yearfirst`` is set to ``True``, this distinguishes between YDM</span></span>
<span class="num"><a href="#14">14</a></span><span><span class="sd">            and YMD. If set to ``None``, this value is retrieved from the</span></span>
<span class="num"><a href="#15">15</a></span><span><span class="sd">            current :class:`parserinfo` object (which itself defaults to</span></span>
<span class="num"><a href="#16">16</a></span><span><span class="sd">            ``False``).</span></span>
<span class="num"><a href="#17">17</a></span><span></span>
<span class="num"><a href="#18">18</a></span><span><span class="sd">        :param yearfirst:</span></span>
<span class="num"><a href="#19">19</a></span><span><span class="sd">            Whether to interpret the first value in an ambiguous 3-integer date</span></span>
<span class="num"><a href="#20">20</a></span><span><span class="sd">            (e.g. 01/05/09) as the year. If ``True``, the first number is taken</span></span>
<span class="num"><a href="#21">21</a></span><span><span class="sd">            to be the year, otherwise the last number is taken to be the year.</span></span>
<span class="num"><a href="#22">22</a></span><span><span class="sd">            If this is set to ``None``, the value is retrieved from the current</span></span>
<span class="num"><a href="#23">23</a></span><span><span class="sd">            :class:`parserinfo` object (which itself defaults to ``False``).</span></span>
<span class="num"><a href="#24">24</a></span><span></span>
<span class="num"><a href="#25">25</a></span><span><span class="sd">        :param fuzzy:</span></span>
<span class="num"><a href="#26">26</a></span><span><span class="sd">            Whether to allow fuzzy parsing, allowing for string like &quot;Today is</span></span>
<span class="num"><a href="#27">27</a></span><span><span class="sd">            January 1, 2047 at 8:21:00AM&quot;.</span></span>
<span class="num"><a href="#28">28</a></span><span></span>
<span class="num"><a href="#29">29</a></span><span><span class="sd">        :param fuzzy_with_tokens:</span></span>
<span class="num"><a href="#30">30</a></span><span><span class="sd">            If ``True``, ``fuzzy`` is automatically set to True, and the parser</span></span>
<span class="num"><a href="#31">31</a></span><span><span class="sd">            will return a tuple where the first element is the parsed</span></span>
<span class="num"><a href="#32">32</a></span><span><span class="sd">            :class:`datetime.datetime` datetimestamp and the second element is</span></span>
<span class="num"><a href="#33">33</a></span><span><span class="sd">            a tuple containing the portions of the string which were ignored:</span></span>
<span class="num"><a href="#34">34</a></span><span></span>
<span class="num"><a href="#35">35</a></span><span><span class="sd">            .. doctest::</span></span>
<span class="num"><a href="#36">36</a></span><span></span>
<span class="num"><a href="#37">37</a></span><span><span class="sd">                &gt;&gt;&gt; from dateutil.parser import parse</span></span>
<span class="num"><a href="#38">38</a></span><span><span class="sd">                &gt;&gt;&gt; parse(&quot;Today is January 1, 2047 at 8:21:00AM&quot;, fuzzy_with_tokens=True)</span></span>
<span class="num"><a href="#39">39</a></span><span><span class="sd">                (datetime.datetime(2047, 1, 1, 8, 21), (u&#39;Today is &#39;, u&#39; &#39;, u&#39;at &#39;))</span></span>
<span class="num"><a href="#40">40</a></span><span></span>
<span class="num"><a href="#41">41</a></span><span><span class="sd">        &quot;&quot;&quot;</span></span>
<span class="num"><a href="#42">42</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#43">43</a></span><span class="full run">            <span class="n">fuzzy</span> <span class="o">=</span> <span class="kc">True</span></span>
<span class="num"><a href="#44">44</a></span><span></span>
<span class="num"><a href="#45">45</a></span><span class="full run">        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span></span>
<span class="num"><a href="#46">46</a></span><span></span>
<span class="num"><a href="#47">47</a></span><span class="full run">        <span class="k">if</span> <span class="n">dayfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#48">48</a></span><span class="full run">            <span class="n">dayfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">dayfirst</span></span>
<span class="num"><a href="#49">49</a></span><span></span>
<span class="num"><a href="#50">50</a></span><span class="full run">        <span class="k">if</span> <span class="n">yearfirst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#51">51</a></span><span class="full run">            <span class="n">yearfirst</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">yearfirst</span></span>
<span class="num"><a href="#52">52</a></span><span></span>
<span class="num"><a href="#53">53</a></span><span class="full run">        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">()</span></span>
<span class="num"><a href="#54">54</a></span><span class="full run">        <span class="n">l</span> <span class="o">=</span> <span class="n">_timelex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span>         <span class="c1"># Splits the timestr into tokens</span></span>
<span class="num"><a href="#55">55</a></span><span></span>
<span class="num"><a href="#56">56</a></span><span class="full run">        <span class="n">skipped_idxs</span> <span class="o">=</span> <span class="p">[]</span></span>
<span class="num"><a href="#57">57</a></span><span></span>
<span class="num"><a href="#58">58</a></span><span>        <span class="c1"># year/month/day list</span></span>
<span class="num"><a href="#59">59</a></span><span class="full run">        <span class="n">ymd</span> <span class="o">=</span> <span class="n">_ymd</span><span class="p">()</span></span>
<span class="num"><a href="#60">60</a></span><span></span>
<span class="num"><a href="#61">61</a></span><span class="full run">        <span class="n">len_l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></span>
<span class="num"><a href="#62">62</a></span><span class="full run">        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#63">63</a></span><span class="full run">        <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#64">64</a></span><span class="full run">            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#65">65</a></span><span></span>
<span class="num"><a href="#66">66</a></span><span>                <span class="c1"># Check if it&#39;s a number</span></span>
<span class="num"><a href="#67">67</a></span><span class="full run">                <span class="n">value_repr</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#68">68</a></span><span class="full run">                <span class="k">try</span><span class="p">:</span></span>
<span class="num"><a href="#69">69</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value_repr</span><span class="p">)</span></span>
<span class="num"><a href="#70">70</a></span><span class="full run">                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span></span>
<span class="num"><a href="#71">71</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#72">72</a></span><span></span>
<span class="num"><a href="#73">73</a></span><span class="full run">                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#74">74</a></span><span>                    <span class="c1"># Numeric token</span></span>
<span class="num"><a href="#75">75</a></span><span class="full run">                    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_numeric_token</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">ymd</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#76">76</a></span><span></span>
<span class="num"><a href="#77">77</a></span><span>                <span class="c1"># Check weekday</span></span>
<span class="num"><a href="#78">78</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#79">79</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">weekday</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#80">80</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#81">81</a></span><span></span>
<span class="num"><a href="#82">82</a></span><span>                <span class="c1"># Check month name</span></span>
<span class="num"><a href="#83">83</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#84">84</a></span><span class="full run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">month</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#85">85</a></span><span class="full run">                    <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#86">86</a></span><span></span>
<span class="num"><a href="#87">87</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span><span class="p">:</span></span>
<span class="num"><a href="#88">88</a></span><span class="full run">                        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#89">89</a></span><span>                            <span class="c1"># Jan-01[-99]</span></span>
<span class="num"><a href="#90">90</a></span><span class="full not_run">                            <span class="n">sep</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span></span>
<span class="num"><a href="#91">91</a></span><span class="full not_run">                            <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#92">92</a></span><span></span>
<span class="num"><a href="#93">93</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep</span><span class="p">:</span></span>
<span class="num"><a href="#94">94</a></span><span>                                <span class="c1"># Jan-01-99</span></span>
<span class="num"><a href="#95">95</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#96">96</a></span><span class="full not_run">                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#97">97</a></span><span></span>
<span class="num"><a href="#98">98</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#99">99</a></span><span></span>
<span class="num"><a href="#100">100</a></span><span class="full run">                        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#101">101</a></span><span class="full not_run">                              <span class="n">info</span><span class="o">.</span><span class="n">pertain</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])):</span></span>
<span class="num"><a href="#102">102</a></span><span>                            <span class="c1"># Jan of 01</span></span>
<span class="num"><a href="#103">103</a></span><span>                            <span class="c1"># In this case, 01 is clearly year</span></span>
<span class="num"><a href="#104">104</a></span><span class="full not_run">                            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span></span>
<span class="num"><a href="#105">105</a></span><span>                                <span class="c1"># Convert it here to become unambiguous</span></span>
<span class="num"><a href="#106">106</a></span><span class="full not_run">                                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span></span>
<span class="num"><a href="#107">107</a></span><span class="full not_run">                                <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">convertyear</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></span>
<span class="num"><a href="#108">108</a></span><span class="full not_run">                                <span class="n">ymd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span></span>
<span class="num"><a href="#109">109</a></span><span>                            <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#110">110</a></span><span>                                <span class="c1"># Wrong guess</span></span>
<span class="num"><a href="#111">111</a></span><span class="full not_run">                                <span class="k">pass</span></span>
<span class="num"><a href="#112">112</a></span><span>                                <span class="c1"># TODO: not hit in tests</span></span>
<span class="num"><a href="#113">113</a></span><span class="full not_run">                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#114">114</a></span><span></span>
<span class="num"><a href="#115">115</a></span><span>                <span class="c1"># Check am/pm</span></span>
<span class="num"><a href="#116">116</a></span><span class="full run">                <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span></span>
<span class="num"><a href="#117">117</a></span><span class="full not_run">                    <span class="n">value</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ampm</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="num"><a href="#118">118</a></span><span class="full not_run">                    <span class="n">val_is_ampm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ampm_valid</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">ampm</span><span class="p">,</span> <span class="n">fuzzy</span><span class="p">)</span></span>
<span class="num"><a href="#119">119</a></span><span></span>
<span class="num"><a href="#120">120</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">val_is_ampm</span><span class="p">:</span></span>
<span class="num"><a href="#121">121</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_ampm</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></span>
<span class="num"><a href="#122">122</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">ampm</span> <span class="o">=</span> <span class="n">value</span></span>
<span class="num"><a href="#123">123</a></span><span></span>
<span class="num"><a href="#124">124</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">fuzzy</span><span class="p">:</span></span>
<span class="num"><a href="#125">125</a></span><span class="full not_run">                        <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#126">126</a></span><span></span>
<span class="num"><a href="#127">127</a></span><span>                <span class="c1"># Check for a timezone name</span></span>
<span class="num"><a href="#128">128</a></span><span class="full run">                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></span>
<span class="num"><a href="#129">129</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></span>
<span class="num"><a href="#130">130</a></span><span class="full run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">tzoffset</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">)</span></span>
<span class="num"><a href="#131">131</a></span><span></span>
<span class="num"><a href="#132">132</a></span><span>                    <span class="c1"># Check for something like GMT+3, or BRST+3. Notice</span></span>
<span class="num"><a href="#133">133</a></span><span>                    <span class="c1"># that it doesn&#39;t mean &quot;I am 3 hours after GMT&quot;, but</span></span>
<span class="num"><a href="#134">134</a></span><span>                    <span class="c1"># &quot;my time +3 is GMT&quot;. If found, we reverse the</span></span>
<span class="num"><a href="#135">135</a></span><span>                    <span class="c1"># logic so that timezone parsing code will get it</span></span>
<span class="num"><a href="#136">136</a></span><span>                    <span class="c1"># right.</span></span>
<span class="num"><a href="#137">137</a></span><span class="full run">                    <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#138">138</a></span><span class="full not_run">                        <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#139">139</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#140">140</a></span><span class="full not_run">                        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">utczone</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">):</span></span>
<span class="num"><a href="#141">141</a></span><span>                            <span class="c1"># With something like GMT+3, the timezone</span></span>
<span class="num"><a href="#142">142</a></span><span>                            <span class="c1"># is *not* GMT.</span></span>
<span class="num"><a href="#143">143</a></span><span class="full not_run">                            <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="kc">None</span></span>
<span class="num"><a href="#144">144</a></span><span></span>
<span class="num"><a href="#145">145</a></span><span>                <span class="c1"># Check for a numbered timezone</span></span>
<span class="num"><a href="#146">146</a></span><span class="full run">                <span class="k">elif</span> <span class="n">res</span><span class="o">.</span><span class="n">hour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span></span>
<span class="num"><a href="#147">147</a></span><span class="full not_run">                    <span class="n">signal</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">]</span></span>
<span class="num"><a href="#148">148</a></span><span class="full not_run">                    <span class="n">len_li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#149">149</a></span><span></span>
<span class="num"><a href="#150">150</a></span><span>                    <span class="c1"># TODO: check that l[i + 1] is integer?</span></span>
<span class="num"><a href="#151">151</a></span><span class="full not_run">                    <span class="k">if</span> <span class="n">len_li</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span></span>
<span class="num"><a href="#152">152</a></span><span>                        <span class="c1"># -0300</span></span>
<span class="num"><a href="#153">153</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#154">154</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span></span>
<span class="num"><a href="#155">155</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span></span>
<span class="num"><a href="#156">156</a></span><span>                        <span class="c1"># -03:00</span></span>
<span class="num"><a href="#157">157</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span></span>
<span class="num"><a href="#158">158</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># TODO: Check that l[i+3] is minute-like?</span></span>
<span class="num"><a href="#159">159</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span></span>
<span class="num"><a href="#160">160</a></span><span class="full not_run">                    <span class="k">elif</span> <span class="n">len_li</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span></span>
<span class="num"><a href="#161">161</a></span><span>                        <span class="c1"># -[0]3</span></span>
<span class="num"><a href="#162">162</a></span><span class="full not_run">                        <span class="n">hour_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span></span>
<span class="num"><a href="#163">163</a></span><span class="full not_run">                        <span class="n">min_offset</span> <span class="o">=</span> <span class="mi">0</span></span>
<span class="num"><a href="#164">164</a></span><span>                    <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#165">165</a></span><span class="full not_run">                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#166">166</a></span><span></span>
<span class="num"><a href="#167">167</a></span><span class="full not_run">                    <span class="n">res</span><span class="o">.</span><span class="n">tzoffset</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="p">(</span><span class="n">hour_offset</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">min_offset</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span></span>
<span class="num"><a href="#168">168</a></span><span></span>
<span class="num"><a href="#169">169</a></span><span>                    <span class="c1"># Look for a timezone name between parenthesis</span></span>
<span class="num"><a href="#170">170</a></span><span class="full not_run">                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">len_l</span> <span class="ow">and</span></span>
<span class="num"><a href="#171">171</a></span><span class="full not_run">                            <span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#172">172</a></span><span class="full not_run">                            <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span> <span class="ow">and</span></span>
<span class="num"><a href="#173">173</a></span><span class="full not_run">                            <span class="mi">3</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="ow">and</span></span>
<span class="num"><a href="#174">174</a></span><span class="full not_run">                            <span class="bp">self</span><span class="o">.</span><span class="n">_could_be_tzname</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">tzname</span><span class="p">,</span></span>
<span class="num"><a href="#175">175</a></span><span class="full not_run">                                                  <span class="kc">None</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])):</span></span>
<span class="num"><a href="#176">176</a></span><span>                        <span class="c1"># -0300 (BRST)</span></span>
<span class="num"><a href="#177">177</a></span><span class="full not_run">                        <span class="n">res</span><span class="o">.</span><span class="n">tzname</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span></span>
<span class="num"><a href="#178">178</a></span><span class="full not_run">                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span></span>
<span class="num"><a href="#179">179</a></span><span></span>
<span class="num"><a href="#180">180</a></span><span class="full not_run">                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#181">181</a></span><span></span>
<span class="num"><a href="#182">182</a></span><span>                <span class="c1"># Check jumps</span></span>
<span class="num"><a href="#183">183</a></span><span class="full run">                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">jump</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="n">fuzzy</span><span class="p">):</span></span>
<span class="num"><a href="#184">184</a></span><span class="full not_run">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">timestr</span><span class="p">)</span></span>
<span class="num"><a href="#185">185</a></span><span></span>
<span class="num"><a href="#186">186</a></span><span>                <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#187">187</a></span><span class="full run">                    <span class="n">skipped_idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></span>
<span class="num"><a href="#188">188</a></span><span class="full run">                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></span>
<span class="num"><a href="#189">189</a></span><span></span>
<span class="num"><a href="#190">190</a></span><span>            <span class="c1"># Process year/month/day</span></span>
<span class="num"><a href="#191">191</a></span><span class="full run">            <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">resolve_ymd</span><span class="p">(</span><span class="n">yearfirst</span><span class="p">,</span> <span class="n">dayfirst</span><span class="p">)</span></span>
<span class="num"><a href="#192">192</a></span><span></span>
<span class="num"><a href="#193">193</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">century_specified</span> <span class="o">=</span> <span class="n">ymd</span><span class="o">.</span><span class="n">century_specified</span></span>
<span class="num"><a href="#194">194</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span></span>
<span class="num"><a href="#195">195</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span></span>
<span class="num"><a href="#196">196</a></span><span class="full run">            <span class="n">res</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span></span>
<span class="num"><a href="#197">197</a></span><span></span>
<span class="num"><a href="#198">198</a></span><span class="full not_run">        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span></span>
<span class="num"><a href="#199">199</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#200">200</a></span><span></span>
<span class="num"><a href="#201">201</a></span><span class="full run">        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span></span>
<span class="num"><a href="#202">202</a></span><span class="full not_run">            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></span>
<span class="num"><a href="#203">203</a></span><span></span>
<span class="num"><a href="#204">204</a></span><span class="full run">        <span class="k">if</span> <span class="n">fuzzy_with_tokens</span><span class="p">:</span></span>
<span class="num"><a href="#205">205</a></span><span class="full run">            <span class="n">skipped_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recombine_skipped</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">skipped_idxs</span><span class="p">)</span></span>
<span class="num"><a href="#206">206</a></span><span class="full run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">skipped_tokens</span><span class="p">)</span></span>
<span class="num"><a href="#207">207</a></span><span>        <span class="k">else</span><span class="p">:</span></span>
<span class="num"><a href="#208">208</a></span><span class="full not_run">            <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="kc">None</span></span>
            </pre>
    </div>
</div>
<i class="bi bi-arrow-down"></i>
</body>
</html>
